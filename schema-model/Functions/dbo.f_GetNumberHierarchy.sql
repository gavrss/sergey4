SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
CREATE FUNCTION [dbo].[f_GetNumberHierarchy]
(
	@MemberKey nvarchar(100),
    @NumberHierarchy int
)
RETURNS nvarchar(100)
AS
BEGIN

	DECLARE
		@ReturnValue  nvarchar(100)

	SET @ReturnValue = 
		CASE @NumberHierarchy - LEN(@MemberKey)
			WHEN  1 THEN '0'
			WHEN  2 THEN '00'
			WHEN  3 THEN '000'
			WHEN  4 THEN '0000'
			WHEN  5 THEN '00000'
			WHEN  6 THEN '000000'
			WHEN  7 THEN '0000000'
			WHEN  8 THEN '00000000'
			WHEN  9 THEN '000000000'
			WHEN 10 THEN '0000000000'
			WHEN 11 THEN '00000000000'
			WHEN 12 THEN '000000000000'
			WHEN 13 THEN '0000000000000'
			WHEN 14 THEN '00000000000000'
			WHEN 15 THEN '000000000000000'
			WHEN 16 THEN '0000000000000000'
			WHEN 17 THEN '00000000000000000'
			WHEN 18 THEN '000000000000000000'
			WHEN 19 THEN '0000000000000000000'
			WHEN 20 THEN '00000000000000000000'
			ELSE ''
		END + @MemberKey

	RETURN @ReturnValue       
END
GO
