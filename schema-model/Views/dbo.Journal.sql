SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

CREATE VIEW [dbo].[Journal] AS
-- Current Version: 2.1.2.2198
-- Created: Apr  2 2025  8:34AM

SELECT 
	[sub].[JobID],
	[sub].[JournalID],
	[sub].[InstanceID],
	[sub].[Entity],
	[sub].[Book],
	[sub].[FiscalYear],
	[sub].[FiscalPeriod],
	[sub].[JournalSequence],
	[sub].[JournalNo],
	[sub].[JournalLine],
	[sub].[YearMonth],
	[sub].[TransactionTypeBM],
	[sub].[BalanceYN],
	[sub].[Account],
	[sub].[Segment01],
	[sub].[Segment02],
	[sub].[Segment03],
	[sub].[Segment04],
	[sub].[Segment05],
	[sub].[Segment06],
	[sub].[Segment07],
	[sub].[Segment08],
	[sub].[Segment09],
	[sub].[Segment10],
	[sub].[Segment11],
	[sub].[Segment12],
	[sub].[Segment13],
	[sub].[Segment14],
	[sub].[Segment15],
	[sub].[Segment16],
	[sub].[Segment17],
	[sub].[Segment18],
	[sub].[Segment19],
	[sub].[Segment20],
	[sub].[JournalDate],
	[sub].[TransactionDate],
	[sub].[PostedDate],
	[sub].[PostedStatus],
	[sub].[PostedBy],
	[sub].[Source],
	[sub].[Flow],
	[sub].[ConsolidationGroup],
	[sub].[InterCompanyEntity],
	[sub].[Scenario],
	[sub].[Description_Head],
	[sub].[Description_Line],
	[sub].[Currency_Book],
	[sub].[ValueDebit_Book],
	[sub].[ValueCredit_Book],
	[sub].[Currency_Transaction],
	[sub].[ValueDebit_Transaction],
	[sub].[ValueCredit_Transaction],
	[sub].[SourceModule],
	[sub].[SourceModuleReference],
	[sub].[Inserted],
	[sub].[InsertedBy],
	[sub].[Customer],
	[sub].[Supplier],
	[sub].[Currency_Group],
	[sub].[ValueDebit_Group],
	[sub].[ValueCredit_Group],
	[sub].[SourceCounter],
	[sub].[SourceGUID]
FROM
	(
	SELECT
		[JobID],
		[JournalID],
		[InstanceID],
		[Entity],
		[Book],
		[FiscalYear],
		[FiscalPeriod],
		[JournalSequence],
		[JournalNo],
		[JournalLine],
		[YearMonth],
		[TransactionTypeBM],
		[BalanceYN],
		[Account],
		[Segment01],
		[Segment02],
		[Segment03],
		[Segment04],
		[Segment05],
		[Segment06],
		[Segment07],
		[Segment08],
		[Segment09],
		[Segment10],
		[Segment11],
		[Segment12],
		[Segment13],
		[Segment14],
		[Segment15],
		[Segment16],
		[Segment17],
		[Segment18],
		[Segment19],
		[Segment20],
		[JournalDate],
		[TransactionDate],
		[PostedDate],
		[PostedStatus],
		[PostedBy],
		[Source],
		[Flow],
		[ConsolidationGroup],
		[InterCompanyEntity],
		[Scenario],
		[Description_Head],
		[Description_Line],
		[Currency_Book],
		[ValueDebit_Book],
		[ValueCredit_Book],
		[Currency_Transaction],
		[ValueDebit_Transaction],
		[ValueCredit_Transaction],
		[SourceModule],
		[SourceModuleReference],
		[Inserted],
		[InsertedBy],
		[Customer],
		[Supplier],
		[Currency_Group],
		[ValueDebit_Group],
		[ValueCredit_Group],
		[SourceCounter],
		[SourceGUID]
	FROM
		[pcINTEGRATOR_Data].[dbo].[Journal]
	WHERE
		InstanceID NOT IN (-10, 0)

	
	UNION
	SELECT
		[JobID],
		[JournalID],
		[InstanceID],
		[Entity],
		[Book],
		[FiscalYear],
		[FiscalPeriod],
		[JournalSequence],
		[JournalNo],
		[JournalLine],
		[YearMonth],
		[TransactionTypeBM],
		[BalanceYN],
		[Account],
		[Segment01],
		[Segment02],
		[Segment03],
		[Segment04],
		[Segment05],
		[Segment06],
		[Segment07],
		[Segment08],
		[Segment09],
		[Segment10],
		[Segment11],
		[Segment12],
		[Segment13],
		[Segment14],
		[Segment15],
		[Segment16],
		[Segment17],
		[Segment18],
		[Segment19],
		[Segment20],
		[JournalDate],
		[TransactionDate],
		[PostedDate],
		[PostedStatus],
		[PostedBy],
		[Source],
		[Flow],
		[ConsolidationGroup],
		[InterCompanyEntity],
		[Scenario],
		[Description_Head],
		[Description_Line],
		[Currency_Book],
		[ValueDebit_Book],
		[ValueCredit_Book],
		[Currency_Transaction],
		[ValueDebit_Transaction],
		[ValueCredit_Transaction],
		[SourceModule],
		[SourceModuleReference],
		[Inserted],
		[InsertedBy],
		[Customer],
		[Supplier],
		[Currency_Group],
		[ValueDebit_Group],
		[ValueCredit_Group],
		[SourceCounter],
		[SourceGUID]
	FROM
		[pcINTEGRATOR].[dbo].[@Template_Journal]
	) sub
GO
